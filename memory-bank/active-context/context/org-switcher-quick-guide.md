# ç»„ç»‡åˆ‡æ¢å™¨å¿«é€Ÿå®æ–½æŒ‡å—ï¼ˆ2 åˆ†é’Ÿé€Ÿè§ˆï¼‰

> **âš¡ å¿«é€Ÿç‰ˆ** - è¯¦ç»†æ–‡æ¡£è§ [å®Œæ•´è®¾è®¡](../../creative-phase/design-decisions/org-switcher-design.md)

---

## ğŸ¯ ä¸€å¥è¯æ€»ç»“

åœ¨ä¾§è¾¹æ é¡¶éƒ¨æ·»åŠ ç»„ç»‡åˆ‡æ¢å™¨ï¼Œå®ç°ä¸ªäººç©ºé—´/ç»„ç»‡ç©ºé—´åˆ‡æ¢ï¼Œåˆ‡æ¢æ—¶æ¸…é™¤æ‰€æœ‰ Tab å¹¶åŠ¨æ€åŠ è½½èœå•ã€‚

---

## ğŸ“ æ–‡ä»¶æ¸…å•ï¼ˆ10 ä¸ªï¼‰

### æ–°å»ºæ–‡ä»¶ï¼ˆ4 ä¸ªï¼‰

```
1. core/services/organization-switcher/organization-switcher.service.ts  (150 è¡Œ)
2. layout/basic-layout/widgets/org-switcher.component.ts                (120 è¡Œ)
3. core/services/organization-switcher/index.ts                         (1 è¡Œ)
4. layout/basic-layout/widgets/index.ts                                 (æ–°å»ºæˆ–è¿½åŠ )
```

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ6 ä¸ªï¼‰

```
5. features/organization/models/organization.model.ts      (+15 è¡Œï¼šæ·»åŠ  OrganizationSwitcherItem æ¥å£)
6. core/index.ts                                           (+1 è¡Œï¼šå¯¼å‡ºæœåŠ¡)
7. layout/basic-layout/basic.component.ts                  (+4 è¡Œï¼šå¯¼å…¥ç»„ä»¶ + æ¨¡æ¿)
8. core/startup/startup.service.ts                         (+8 è¡Œï¼šåˆå§‹åŒ–)
9. assets/tmp/app-data.json                                (+60 è¡Œï¼šorganizations + menus)
10. assets/tmp/i18n/*.json                                 (12 ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ª +4 è¡Œç¿»è¯‘)
```

---

## ğŸ”„ Tab ç³»ç»Ÿé›†æˆï¼ˆæ ¸å¿ƒï¼‰

### åˆ‡æ¢æµç¨‹

```
ç”¨æˆ·åˆ‡æ¢ç»„ç»‡
    â†“
TabService.clearTabs()        â† æ¸…é™¤æ‰€æœ‰ Tab
    â†“
MenuService.clear()           â† æ¸…é™¤æ—§èœå•
    â†“
MenuService.add(newMenu)      â† åŠ è½½æ–°èœå•
    â†“
Router.navigateByUrl('/dashboard')  â† è·³è½¬é¦–é¡µ
```

### ä¸ºä»€ä¹ˆè¦æ¸…é™¤ Tabï¼Ÿ

```
âœ… é¿å…è·¨ç»„ç»‡ Tab æ··ä¹±
âœ… ç”¨æˆ·ä½“éªŒæ¸…æ™°ï¼ˆæ˜ç¡®çŸ¥é“åˆ‡æ¢äº†ç©ºé—´ï¼‰
âœ… é¿å…æƒé™é—®é¢˜ï¼ˆç»„ç»‡ A çš„é¡µé¢åœ¨ç»„ç»‡ B å¯èƒ½æ— æƒé™ï¼‰
âœ… é¿å…æ•°æ®æ··æ·†
```

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### ä¾§è¾¹æ å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Logo] æˆ‘çš„çµ„ç¹” â–¼  â”‚ â† ç»„ç»‡åˆ‡æ¢å™¨ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Dashboard        â”‚
â”‚ â€¢ çµ„ç¹”ç®¡ç†         â”‚ â† èœå•ï¼ˆåŠ¨æ€ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å¤´åƒ] Admin       â”‚ â† ç”¨æˆ·ä¿¡æ¯ï¼ˆåŸæœ‰ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸‹æ‹‰èœå•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [A] å€‹äººç©ºé–“      âœ“  â”‚ â† å½“å‰é€‰ä¸­
â”‚ [M] æˆ‘çš„çµ„ç¹”         â”‚
â”‚ [T] æŠ€è¡“éƒ¨é–€         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ [+] æ–°å¢çµ„ç¹”         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## â±ï¸ å®æ–½æ—¶é—´è¡¨

### é˜¶æ®µ 1ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ3-4 å°æ—¶ï¼‰

```
1. åˆ›å»º OrganizationSwitcherService          (1 å°æ—¶)
2. åˆ›å»º OrgSwitcherComponent                 (1.5 å°æ—¶)
3. ä¿®æ”¹ basic.component.ts é›†æˆ              (30 åˆ†é’Ÿ)
4. æ‰©å±• Organization æ¨¡å‹                    (15 åˆ†é’Ÿ)
5. å‡†å¤‡ Mock æ•°æ®                            (30 åˆ†é’Ÿ)
6. æµ‹è¯•åŸºæœ¬åŠŸèƒ½                              (30 åˆ†é’Ÿ)
```

### é˜¶æ®µ 2ï¼šå›½é™…åŒ–ï¼ˆ1 å°æ—¶ï¼‰

```
7. æ·»åŠ ç¿»è¯‘ï¼ˆ12 ç§è¯­è¨€ï¼‰                     (30 åˆ†é’Ÿ)
8. æ ·å¼ä¼˜åŒ–                                  (30 åˆ†é’Ÿ)
```

### é˜¶æ®µ 3ï¼šæµ‹è¯•æ–‡æ¡£ï¼ˆ1 å°æ—¶ï¼‰

```
9. åŠŸèƒ½æµ‹è¯•                                  (30 åˆ†é’Ÿ)
10. ç¼–å†™æ–‡æ¡£                                 (30 åˆ†é’Ÿ)
```

**æ€»è®¡**: 4-6 å°æ—¶

---

## âœ… æ ¸å¿ƒä»£ç ç‰‡æ®µ

### æœåŠ¡æ ¸å¿ƒæ–¹æ³•

```typescript
switchOrganization(orgId: string): void {
  // 1. æ›´æ–°çŠ¶æ€
  this._currentOrg.set(targetOrg);
  localStorage.setItem('current_organization_id', orgId);
  
  // 2. â­ æ¸…é™¤ Tabï¼ˆå…³é”®ï¼‰
  this.tabService.clearTabs();
  
  // 3. æ›´æ–°èœå•
  this.menuService.clear();
  this.loadMenuForOrganization(orgId);
  
  // 4. è·³è½¬é¦–é¡µ
  this.router.navigateByUrl('/dashboard');
}
```

### å¸ƒå±€é›†æˆ

```html
<ng-template #asideUserTpl>
  <!-- âœ¨ æ–°å¢ -->
  <org-switcher class="mb-md" />
  <li nz-menu-divider></li>
  
  <!-- åŸæœ‰ -->
  <div nz-dropdown ...>
    <nz-avatar ... />
    ...
  </div>
</ng-template>
```

---

## ğŸ¯ æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1ï¼šåŸºæœ¬åˆ‡æ¢

```
1. ç™»å½• â†’ æ˜¾ç¤º"å€‹äººç©ºé–“"
2. ç‚¹å‡»åˆ‡æ¢å™¨ â†’ çœ‹åˆ°ä¸‹æ‹‰èœå•
3. é€‰æ‹©"æˆ‘çš„çµ„ç¹”" â†’ åˆ‡æ¢æˆåŠŸ
4. éªŒè¯ï¼šTab æ¸…é™¤ï¼Œèœå•æ›´æ–°ï¼Œè·³è½¬é¦–é¡µ
```

### åœºæ™¯ 2ï¼šTab é›†æˆ

```
1. åœ¨ç»„ç»‡ A æ‰“å¼€ 3 ä¸ª Tab
2. åˆ‡æ¢åˆ°ä¸ªäººç©ºé—´
3. éªŒè¯ï¼šæ‰€æœ‰ Tab è¢«æ¸…é™¤
4. é‡æ–°æ‰“å¼€é¡µé¢ â†’ Tab ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
```

### åœºæ™¯ 3ï¼šåˆ·æ–°æ¢å¤

```
1. åˆ‡æ¢åˆ°ç»„ç»‡ A
2. åˆ·æ–°é¡µé¢ï¼ˆF5ï¼‰
3. éªŒè¯ï¼šç»„ç»‡çŠ¶æ€æ¢å¤ï¼Œèœå•æ­£ç¡®åŠ è½½
```

---

## ğŸ”— å¿«é€Ÿå¯¼èˆª

- **å®Œæ•´è®¾è®¡æ–‡æ¡£** â†’ [org-switcher-design.md](../../creative-phase/design-decisions/org-switcher-design.md)
- **è¯¦ç»†å®æ–½è®¡åˆ’** â†’ [org-switcher-implementation-plan.md](./org-switcher-implementation-plan.md)
- **Tab ç³»ç»Ÿæ–‡æ¡£** â†’ [tab-system-guide.md](./tab-system-guide.md)
- **Organization æ¨¡å—** â†’ [../../../src/app/features/organization/README.md](../../../src/app/features/organization/README.md)

---

## âš™ï¸ æŠ€æœ¯æ ˆ

```
é›¶æ–°å¢ä¾èµ– âœ…

ä½¿ç”¨ç°æœ‰ï¼š
- Angular Signalsï¼ˆçŠ¶æ€ç®¡ç†ï¼‰
- @delon/themeï¼ˆMenuServiceï¼‰
- TabServiceï¼ˆPhase 3 å·²å®ç°ï¼‰
- ng-zorroï¼ˆdropdown, avatar, menuï¼‰
```

---

**å‡†å¤‡çŠ¶æ€**: âœ… è®¾è®¡å®Œæˆï¼Œå¯ç«‹å³å®æ–½  
**é¢„è®¡å·¥æ—¶**: 4-6 å°æ—¶  
**é£é™©è¯„ä¼°**: ä½ï¼ˆé›¶ç ´åæ€§ï¼‰



